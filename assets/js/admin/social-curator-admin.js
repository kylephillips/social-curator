jQuery(function(a){function t(t){var o=a(".social-curator-post-grid").masonry({itemSelector:".social-curator-post-grid-single",percentPosition:!0,gutter:".gutter-sizer"});o.imagesLoaded(function(){o.masonry()}),t&&o.prepend(t).masonry("prepended",t)}function o(){n(!0),a("[data-social-curator-manual-import]").attr("disabled","disabled").text(social_curator_admin.importing),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_manual_import"},success:function(t){a("[data-social-curator-last-import]").text(t.import_date),r(t.import_count),c(t.posts)}})}function r(t){a("[data-social-curator-import-count]").find("span").text(t),a("[data-social-curator-import-count]").show()}function i(t){a("[data-social-curator-unmoderated-count]").text(t)}function n(t){t?a("[data-curation-loader]").show():a("[data-curation-loader]").hide()}function c(t){return 0===t.length?void d():void a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_get_posts",posts:t,status:["pending","publish"]},success:function(a){i(a.unmoderated_count),s(a.posts)}})}function s(a){for(var t=0;t<a.length;t++)e(a[t]);d()}function e(o){var r=a("[data-post-template]").find(".social-curator-post-grid-single").clone();if(a(r).find("[data-icon-link]").html(o.icon_link),a(r).find("[data-profile-image]").attr("src",o.profile_image_link),a(r).find("[data-profile-link]").attr("href",o.profile_link),a(r).find("[data-date]").text(o.date),a(r).find("[data-profile-name]").text(o.profile_name),a(r).find("[data-post-id]").attr("data-post-id",o.id),a(r).attr("data-post-container-id",o.id),o.thumbnail){var i='<img src="'+o.thumbnail+'" />';a(r).find("[data-thumbnail]").html(i)}if(o.content){var n=o.content;n+='<p><a href="'+o.edit_link+'">('+social_curator_admin.edit+")</a></p>",a(r).find("[data-post-content]").html(n)}t(r),"publish"===o.status&&f(o),"trash"===o.status&&p(o)}function d(){n(!1),a("[data-social-curator-manual-import]").attr("disabled",!1).text(social_curator_admin.run_import)}function u(t){n(!0),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_trash_post",post_id:t},success:function(){n(!1)}})}function l(){var t=a("[data-social-curator-unmoderated-count]").text();t-=1,a("[data-social-curator-unmoderated-count]").text(t)}function p(t){var o='<div class="social-curator-status-buttons">';o+='<a href="#" data-permanent-delete-post data-post-id="'+t.id+'" class="social-curator-trash"><i class="social-curator-icon-blocked"></i>'+social_curator_admin.permanently_delete+"</a>",o+='<a href="#" data-restore-post data-post-id="'+t.id+'" class="social-curator-approve"><i class="social-curator-icon-redo"></i>'+social_curator_admin.restore+"</a>";var r=a("[data-post-container-id="+t.id+"]");a(r).find(".social-curator-status-buttons").remove(),a(r).append(o)}function _(o){n(!0),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_approve_post",post_id:o},success:function(a){f(a),t(),n(!1)}})}function f(t){var o='<div class="social-curator-alert-success">'+social_curator_admin.approved_by+" "+t.approved_by+" "+social_curator_admin.on+" "+t.approved_date+"</div>",r=a("[data-post-container-id="+t.id+"]");a(r).find(".social-curator-status-buttons").remove(),a(r).append(o),a(r).addClass("approved")}function m(t){n(!0),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_restore_post",post_id:t},success:function(a){console.log(a),h(t),n(!1)}})}function v(t){n(!0),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_delete_post",post_id:t},success:function(a){console.log(a),h(t),n(!1)}})}function h(o){var r=a("[data-post-container-id="+o+"]");a(".social-curator-post-grid").masonry("remove",r),t()}function g(){n(!0),a("[data-post-grid]").find(".social-curator-post-grid-single").remove(),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_get_posts",status:a("[data-filter-status]").val(),site:a("[data-filter-site]").val()},success:function(a){s(a.posts)}})}a(document).ready(function(){t(!1)}),a(document).on("click","[data-social-curator-manual-import]",function(a){a.preventDefault(),o()}),a(document).on("click","[data-trash-post]",function(o){o.preventDefault(),u(a(this).attr("data-post-id")),l(),a(this).parents(".social-curator-post-grid-single").fadeOut("fast",function(){a(".social-curator-post-grid").masonry("remove",a(this)),t()})}),a(document).on("click","[data-approve-post]",function(t){t.preventDefault(),_(a(this).attr("data-post-id"))}),a(document).on("click","[data-restore-post]",function(t){t.preventDefault();var o=a(this).attr("data-post-id");m(o)}),a(document).on("click","[data-permanent-delete-post]",function(t){t.preventDefault();var o=a(this).attr("data-post-id");v(o)}),a(document).on("click","[data-filter-grid]",function(a){a.preventDefault(),g()}),a(document).on("click",'[data-dismiss="alert"]',function(t){t.preventDefault(),a(this).parents(".social-curator-alert").fadeOut("fast")})});