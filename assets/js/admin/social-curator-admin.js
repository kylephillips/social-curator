!function(t,a){"use strict";"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(o,r){return a(t,o,r)}):"object"==typeof exports?module.exports=a(t,require("wolfy87-eventemitter"),require("eventie")):t.imagesLoaded=a(t,t.EventEmitter,t.eventie)}(window,function(t,a,o){"use strict";function r(t,a){for(var o in a)t[o]=a[o];return t}function e(t){return"[object Array]"===p.call(t)}function i(t){var a=[];if(e(t))a=t;else if("number"==typeof t.length)for(var o=0,r=t.length;r>o;o++)a.push(t[o]);else a.push(t);return a}function n(t,a,o){if(!(this instanceof n))return new n(t,a);"string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=i(t),this.options=r({},this.options),"function"==typeof a?o=a:r(this.options,a),o&&this.on("always",o),this.getImages(),d&&(this.jqDeferred=new d.Deferred);var e=this;setTimeout(function(){e.check()})}function s(t){this.img=t}function c(t){this.src=t,f[t]=this}var d=t.jQuery,u=t.console,l="undefined"!=typeof u,p=Object.prototype.toString;n.prototype=new a,n.prototype.options={},n.prototype.getImages=function(){this.images=[];for(var t=0,a=this.elements.length;a>t;t++){var o=this.elements[t];"IMG"===o.nodeName&&this.addImage(o);var r=o.nodeType;if(r&&(1===r||9===r||11===r))for(var e=o.querySelectorAll("img"),i=0,n=e.length;n>i;i++){var s=e[i];this.addImage(s)}}},n.prototype.addImage=function(t){var a=new s(t);this.images.push(a)},n.prototype.check=function(){function t(t,e){return a.options.debug&&l&&u.log("confirm",t,e),a.progress(t),o++,o===r&&a.complete(),!0}var a=this,o=0,r=this.images.length;if(this.hasAnyBroken=!1,!r)return void this.complete();for(var e=0;r>e;e++){var i=this.images[e];i.on("confirm",t),i.check()}},n.prototype.progress=function(t){this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded;var a=this;setTimeout(function(){a.emit("progress",a,t),a.jqDeferred&&a.jqDeferred.notify&&a.jqDeferred.notify(a,t)})},n.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var a=this;setTimeout(function(){if(a.emit(t,a),a.emit("always",a),a.jqDeferred){var o=a.hasAnyBroken?"reject":"resolve";a.jqDeferred[o](a)}})},d&&(d.fn.imagesLoaded=function(t,a){var o=new n(this,t,a);return o.jqDeferred.promise(d(this))}),s.prototype=new a,s.prototype.check=function(){var t=f[this.img.src]||new c(this.img.src);if(t.isConfirmed)return void this.confirm(t.isLoaded,"cached was confirmed");if(this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var a=this;t.on("confirm",function(t,o){return a.confirm(t.isLoaded,o),!0}),t.check()},s.prototype.confirm=function(t,a){this.isLoaded=t,this.emit("confirm",this,a)};var f={};return c.prototype=new a,c.prototype.check=function(){if(!this.isChecked){var t=new Image;o.bind(t,"load",this),o.bind(t,"error",this),t.src=this.src,this.isChecked=!0}},c.prototype.handleEvent=function(t){var a="on"+t.type;this[a]&&this[a](t)},c.prototype.onload=function(t){this.confirm(!0,"onload"),this.unbindProxyEvents(t)},c.prototype.onerror=function(t){this.confirm(!1,"onerror"),this.unbindProxyEvents(t)},c.prototype.confirm=function(t,a){this.isConfirmed=!0,this.isLoaded=t,this.emit("confirm",this,a)},c.prototype.unbindProxyEvents=function(t){o.unbind(t.target,"load",this),o.unbind(t.target,"error",this)},n}),jQuery(document).ready(function(){new SocialCuratorBulkImport});var SocialCuratorBulkImport=function(){var t=this,a=jQuery;return t.post_ids="[data-bulk-import-ids]",t.site="[data-bulk-import-site]",t.button=a("[data-bulk-import]"),t.statusAlert=a("[data-import-status]"),t.errorAlert=a("[data-import-error]"),t.successAlert=a("[data-import-success]"),t.init=function(){t.bindEvents()},t.bindEvents=function(){a(t.button).on("click",function(a){a.preventDefault(),t.startImport()})},t.startImport=function(){t.loading(!0),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_bulk_import",site:a(t.site).val(),post_ids:a(t.post_ids).val()},success:function(o){return t.loading(!1),"error"===o.status?void a(t.errorAlert).text(o.message).show():void t.showSuccess(o)}})},t.showSuccess=function(o){if(html="<p><strong>"+o.import_count+" new posts imported.</strong></p>",o.errors.length>0){html+="<p>There were "+o.errors.length+" errors during the import:</p><ul>";for(var r=0;r<o.errors.length;r++)html+="<li>"+o.errors[r]+"</li>";html+="</ul>"}a(t.successAlert).html(html).show()},t.loading=function(o){return o?(a(t.statusAlert).show(),a(t.errorAlert).hide(),a(t.successAlert).hide(),a(t.button).text(social_curator_admin.importing).attr("disabled","disabled"),void a("[data-bulk-import-loader]").show()):(a(t.statusAlert).hide(),a(t.button).text(social_curator_admin.run_import).attr("disabled",!1),void a("[data-bulk-import-loader").hide())},t.init()},SocialCuratorLogs=function(){var t=this,a=jQuery;return t.button="[data-social-curator-clear-logs]",t.init=function(){t.bindEvents()},t.bindEvents=function(){a(document).on("click",t.button,function(a){a.preventDefault(),t.clearLogs()})},t.clearLogs=function(){t.toggleLoading(!0),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_clear_logs"},success:function(a){t.toggleLoading(!1),console.log(a),document.location.reload(!0)}})},t.toggleLoading=function(o){return o?(a(t.button).attr("disabled","disabled"),void a("[data-log-clear-loader]").css("display","inline-block")):(a(t.button).attr("disabled",!1),void a("[data-log-clear-loader]").css("display","none"))},t.init()};jQuery(document).ready(function(){new SocialCuratorAvatarUpdater});var SocialCuratorAvatarUpdater=function(){var t=this,a=jQuery;return t.button="[data-choose-avatar-image]",t.init=function(){t.bindEvents()},t.bindEvents=function(){a(document).on("click",t.button,function(){t.showMediaLibrary()})},t.showMediaLibrary=function(){return formfield=a("[data-fallback-avatar-field]").attr("name"),tb_show("","media-upload.php?type=image&TB_iframe=true"),!1},window.send_to_editor=function(t){imgurl=a("img",t).attr("src"),a("[data-avatar-image]").find("img").attr("src",imgurl),a("[data-fallback-avatar-field]").val(imgurl),tb_remove()},t.init()};jQuery(document).ready(function(){new SocialCuratorAlert});var SocialCuratorAlert=function(){var t=this,a=jQuery;return t.button='[data-dismiss="alert"]',t.el="",t.init=function(){t.bindEvents()},t.bindEvents=function(){a(document).on("click",t.button,function(o){o.preventDefault(),t.el=a(this).parents(".social-curator-alert"),t.closeAlert()})},t.closeAlert=function(){a(t.el).fadeOut("fast")},t.init()},SocialCuratorModal=function(){var t=this,a=jQuery;return t.modal_id="",t.init=function(){this.bindEvents()},t.bindEvents=function(){a(document).on("click","[data-social-curator-modal-open]",function(o){o.preventDefault(),t.modal_id=a(this).attr("data-social-curator-modal-open"),t.openModal()}),a(document).on("click","[data-social-curator-modal-close]",function(a){a.preventDefault(),t.closeModals()}),a(document).on("click","[data-social-curator-modal]",function(o){0===a(o.target).parents(".social-curator-modal-content").length&&t.closeModals()})},t.openModal=function(){a('[data-social-curator-modal="'+t.modal_id+'"]').addClass("open")},t.closeModals=function(){a("[data-social-curator-modal]").removeClass("open")},t.init()},SocialCuratorDropdown=function(){var t=this,a=jQuery;return t.toggleButton='[data-toggle="social-curator-dropdown"]',t.currentDropdown="",t.init=function(){t.bindEvents()},t.bindEvents=function(){a(document).on("click",t.toggleButton,function(o){o.preventDefault(),t.currentDropdown=a(this).siblings(".social-curator-dropdown-content"),t.toggleDropdown()}),a(document).on("click",function(a){t.windowListener(a.target)})},t.toggleDropdown=function(){a(t.currentDropdown).is(":visible")?a(".social-curator-dropdown-content").hide():(a(".social-curator-dropdown-content").hide(),a(t.currentDropdown).show()),a(t.currentDropdown).parents(".social-curator-dropdown").toggleClass("open")},t.windowListener=function(t){0==a(t).parents(".social-curator-dropdown").length&&(a(".social-curator-dropdown-content").hide(),a(".social-curator-dropdown").removeClass("open"))},t.closeAll=function(){a(".social-curator-dropdown-content").hide(),a(".social-curator-dropdown").removeClass("open")},t.init()};jQuery(document).ready(function(){new SocialCuratorTestFeed});var SocialCuratorTestFeed=function(){var t=this,a=jQuery;return t.loadButton="[data-test-feed]",t.feedContainer="[data-test-feed-results]",t.site="",t.feedType="search",t.loadingText=social_curator_admin.fetching_feed,t.buttonText=social_curator_admin.test_feed,t.errorDiv="[data-test-feed-error]",t.init=function(){t.bindEvents()},t.bindEvents=function(){a(document).on("click",t.loadButton,function(o){o.preventDefault(),t.site=a(this).attr("data-site"),t.getFeed()}),a(document).on("change","[data-feed-type]",function(){var t=a("input[name=feed-type]:checked").val();return"single"===t?void a("[data-feed-id-container]").show():void a("[data-feed-id-container]").hide()})},t.getFeed=function(){t.loading(!0),a.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_test_feed",site:t.site,type:a("input[name=feed-type]:checked").val(),format:a("input[name=feed-format]:checked").val(),id:a("[data-feed-id]").val()},success:function(o){console.log(o),"success"===o.status?t.populateFeed(o.feed):(a(t.errorDiv).text(o.message).show(),a(t.loading(!1)),a(t.feedContainer).hide())}})},t.populateFeed=function(o){var r=print_r(o);a(t.feedContainer).html("<pre>"+r+"</pre>"),t.loading(!1)},t.loading=function(o){return a(t.feedContainer).show(),o?(a(t.errorDiv).hide(),a(t.feedContainer).empty().addClass("loading"),void a(t.loadButton).attr("disabled","disabled").text(t.loadingText)):(a(t.feedContainer).removeClass("loading"),void a(t.loadButton).attr("disabled",!1).text(t.buttonText))},t.init()},print_r=function(t,a){var o=a||"",r="[object Array]"===Object.prototype.toString.call(t),e=r?"Array\n"+o+"[\n":"Object\n"+o+"{\n";for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],s="",c=Object.prototype.toString.call(n);switch(c){case"[object Array]":case"[object Object]":s=print_r(n,o+"	");break;case"[object String]":s="'"+n+"'";break;default:s=n}e+=o+"	"+i+" => "+s+",\n"}return e=e.substring(0,e.length-2)+"\n"+o,r?e+"]":e+"}"};jQuery(function(t){function a(a,e){if(t(L).masonry({itemSelector:".social-curator-post-grid-single",percentPosition:!0,gutter:".gutter-sizer"}),t(L).imagesLoaded(function(){t(L).masonry()}),a){if(e)return o(a);r(a)}}function o(a){setTimeout(function(){t(L).append(a).masonry("reload")},500)}function r(a){setTimeout(function(){t(L).prepend(a).masonry("reload")},500)}function e(a){if(t("[data-social-curator-import-error]").parents(".social-curator-alert-error").hide(),d(!0),t("[data-import-site], [data-social-curator-single-import]").attr("disabled","disabled"),t("[data-social-curator-import-all], [data-social-curator-single-import]").attr("disabled","disabled").text(social_curator_admin.importing),!a)var a="all";t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_manual_import",site:a},success:function(a){console.log(a),"success"===a.status?(t("[data-social-curator-last-import]").text(a.import_date),n(a),a.import_count>30&&document.location.reload(!0),u(a.posts)):c(a.message)}})}function i(){t("[data-social-curator-import-error]").parents(".social-curator-alert-error").hide(),d(!0),t("[data-import-site], [data-social-curator-single-import]").attr("disabled","disabled"),t("[data-social-curator-import-all], [data-social-curator-single-import]").attr("disabled","disabled").text(social_curator_admin.importing);var a=t("[data-social-curator-single-import-site]").val(),o=t("[data-social-curator-single-import-id]").val();t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_single_import",site:a,id:o},success:function(a){"success"===a.status?(t("[data-social-curator-last-import]").text(a.import_date),n(a),a.import_count>30&&document.location.reload(!0),u(a.posts)):c(a.message)}})}function n(a){t("[data-social-curator-import-count]").text(a.import_count),t("[data-social-curator-import-site]").text(a.site),t("[data-social-curator-import-count]").parents(".social-curator-alert").show()}function s(a){t("[data-social-curator-unmoderated-count]").text(a)}function c(a){t("[data-social-curator-import-error]").text(a),t("[data-social-curator-import-error]").parents(".social-curator-alert-error").show(),f()}function d(a){a?t("[data-curation-loader]").show():t("[data-curation-loader]").hide()}function u(a){return 0===a.length?void f():void t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_get_posts",posts:a,status:["pending"],adminview:!0},success:function(t){s(t.unmoderated_count),l(t.posts)}})}function l(t,o){for(var o=o?!0:!1,r=[],e=0;e<t.length;e++)r[e]=p(t[e]);a(r,o),f()}function p(a){var o=t("[data-post-template]").find(".social-curator-post-grid-single").clone();if(t(o).find("[data-icon-link]").html(a.icon_link),t(o).find("[data-profile-image]").attr("src",a.profile_image_link),t(o).find("[data-profile-link]").attr("href",a.profile_link),t(o).find("[data-date]").text(a.date),t(o).find("[data-profile-name]").text(a.profile_name),t(o).find("[data-post-id]").attr("data-post-id",a.id),t(o).attr("data-post-container-id",a.id),a.thumbnail){var r='<img src="'+a.thumbnail+'" />';t(o).find("[data-thumbnail]").html(r)}if(a.content){var e=a.content;e+='<p><a href="'+a.edit_link+'">('+social_curator_admin.edit+")</a></p>",t(o).find("[data-post-content]").html(e)}return"publish"===a.status&&b(a,t(o)),"trash"===a.status&&_(a,t(o)),o[0]}function f(){d(!1),t("[data-social-curator-import-all], [data-social-curator-single-import]").attr("disabled",!1).text(social_curator_admin.run_import),t("[data-import-site], [data-social-curator-single-import]").attr("disabled",!1),t("[data-social-curator-single-import-id]").val(""),T.closeAll(),""!==A&&(E.text(A),A="",E="")}function m(a){d(!0),t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_trash_post",post_id:a},success:function(){t("[data-trash-count]").text(parseInt(t("[data-trash-count]").text())+1),d(!1)}})}function h(){var a=parseInt(t("[data-social-curator-unmoderated-count]").first().text());a-=1,t("[data-social-curator-unmoderated-count]").text(a)}function v(){var a=parseInt(t("[data-social-curator-unmoderated-count]").first().text());a+=1,t("[data-social-curator-unmoderated-count]").text(a)}function _(a,o){var r='<div class="social-curator-status-buttons">';r+='<button data-permanent-delete-post data-post-id="'+a.id+'" class="social-curator-trash"><i class="social-curator-icon-blocked"></i>'+social_curator_admin.permanently_delete+"</button>",r+='<button data-restore-post data-post-id="'+a.id+'" class="social-curator-approve"><i class="social-curator-icon-redo"></i>'+social_curator_admin.restore+"</button>";var e=o?o:t("[data-post-container-id="+a.id+"]");t(e).find(".social-curator-status-buttons").remove(),t(e).append(r)}function g(o){d(!0),t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_approve_post",post_id:o},success:function(t){b(t),h(),a(),d(!1)}})}function b(a,o){var r='<div class="social-curator-alert-success">'+social_curator_admin.approved_by+" "+a.approved_by+" "+social_curator_admin.on+" "+a.approved_date;"1"===social_curator_admin.can_delete_posts&&(r+='<br><a href="#" data-trash-post data-post-id="'+a.id+'" class="unapprove-link">Unapprove and Trash</a>'),r+="</div>";var e=o?o:t("[data-post-container-id="+a.id+"]");t(e).find(".social-curator-status-buttons").remove(),t(e).append(r),t(e).addClass("approved")}function y(a){d(!0),t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_restore_post",post_id:a},success:function(o){v(),w(a),d(!1),t("[data-trash-count]").text(parseInt(t("[data-trash-count]").text())-1)}})}function x(a){d(!0),t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_delete_post",post_id:a},success:function(o){console.log(o),w(a),d(!1),t("[data-trash-count]").text(parseInt(t("[data-trash-count]").text())-1)}})}function w(o){var r=t("[data-post-container-id="+o+"]");t(".social-curator-post-grid").masonry("remove",r),a()}function j(){d(!0),t("[data-post-grid]").find(".social-curator-post-grid-single").remove(),t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_get_posts",status:t("[data-filter-status]").val(),site:t("[data-filter-site]").val(),offset:0,number:O},success:function(a){t("[data-social-curator-load-more]").attr("disabled",!1).text("Load More"),l(a.posts)}})}function k(a,o,r){t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_update_post_status",post_id:a,status:o},success:function(a){t(r).attr("disabled",!1).text(social_curator_admin.update),"trash"===o&&t(r).parents("tr").fadeOut("fast",function(){t(this).remove()})}})}function D(){d(!0),t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_empty_trash"},success:function(a){d(!1),t("[data-trash-count]").text("0"),t("[data-empty-social-trash]").attr("disabled",!1),"trash"===t("[data-filter-status]").val()&&t("[data-post-grid]").find(".social-curator-post-grid-single").remove()}})}function S(){C(!0);var a="all"===t("[data-filter-status]").val()?null:t("[data-filter-status]").val(),o="all"===t("[data-filter-site]").val()?null:t("[data-filter-site]").val();t.ajax({url:ajaxurl,type:"POST",data:{nonce:social_curator_admin.social_curator_nonce,action:"social_curator_get_posts",offset:P,number:O,site:o,status:a},success:function(a){P+=O,C(!1),0===a.posts.length&&t("[data-social-curator-load-more]").attr("disabled","disabled").text("No More Posts"),l(a.posts,!0)}})}function C(a){return a?t("[data-social-curator-grid-loading]").show():t("[data-social-curator-grid-loading]").hide()}var T=new SocialCuratorDropdown,A=(new SocialCuratorModal,""),E="",O=10,P=O,L=t(".social-curator-post-grid");t(document).ready(function(){a()}),t(document).on("click","[data-social-curator-import-all]",function(t){t.preventDefault(),e()}),t(document).on("click","[data-import-site]",function(a){a.preventDefault(),A=t(this).text(),E=t(this);var o=t(this).attr("data-import-site");t(this).text(social_curator_admin.importing),e(o)}),t(document).on("click","[data-social-curator-single-import]",function(t){t.preventDefault(),i()}),t(document).on("change","[data-social-curator-single-import-site]",function(){var a=t(this).val();t("[data-id-help-modal]").attr("data-social-curator-modal-open","id-help-"+a)}),t(document).on("click","[data-trash-post]",function(o){o.preventDefault(),m(t(this).attr("data-post-id")),t(this).attr("disabled","disabled"),t(this).parents(".social-curator-post-grid-single").hasClass("approved")||h(),t(this).parents(".social-curator-post-grid-single").fadeOut("fast",function(){t(".social-curator-post-grid").masonry("remove",t(this)),a()})}),t(document).on("click","[data-approve-post]",function(a){a.preventDefault(),t(this).attr("disabled","disabled"),g(t(this).attr("data-post-id"))}),t(document).on("click","[data-restore-post]",function(a){a.preventDefault(),t(this).attr("disabled","disabled");var o=t(this).attr("data-post-id");y(o)}),t(document).on("click","[data-permanent-delete-post]",function(a){a.preventDefault(),t(this).attr("disabled","disabled");var o=t(this).attr("data-post-id");x(o)}),t(document).on("click","[data-filter-grid]",function(t){t.preventDefault(),j()}),t(document).on("click","[data-social-curator-moderate-select-button]",function(a){a.preventDefault();var o=t(this).attr("data-post-id"),r=t(this).siblings("[data-social-curator-moderate-select]").val(),e=t(this);t(this).attr("disabled","disabled").text(social_curator_admin.updating),k(o,r,e)}),t(document).on("click","[data-empty-social-trash]",function(a){a.preventDefault(),window.confirm("Are you sure you want to empty the trash?")&&(t(this).attr("disabled","disabled"),D())}),t(document).on("click","[data-social-curator-load-more]",function(t){t.preventDefault(),S()})});